{% extends 'base.html' %}


{% block pack %}
<style>
    .star-rating {
        white-space: nowrap;
    }
    .star-rating [type="radio"] {
        appearance: none;
    }
    .star-rating i {
        font-size: 1.2em;
        transition: 0.3s;
    }
    
    .star-rating label:is(:hover, :has(~ :hover)) i {
        transform: scale(1.35);
        color: #fffdba;
        animation: jump 0.5s calc(0.3s + (var(--i) - 1) * 0.15s) alternate infinite;
    }
    .star-rating label:has(~ :checked) i {
        color: #faec1b;
        text-shadow: 0 0 2px #ffffff, 0 0 10px #ffee58;
    }
    
    @keyframes jump {
        0%,
        50% {
            transform: translatey(0) scale(1.35);
        }
        100% {
            transform: translatey(-15%) scale(1.35);
        }
    }
</style>
{% endblock pack %}
    

{% block content %}
    <h2>Book Detail</h2>
    <ul>
        <li>Title: {{detail.book_title}}</li>
        <li>Author: {{detail.book_author}}</li>
        <li>Position: {{ detail.book_position }}</li>
        <li>Publish: {{ detail.book_publish }}</li>
        <li><img src= "{{ detail.bookImage.url }}" alt="image of manga {{myManga.title}}"></li>
    </ul>
    <div hx-post = "/wishCheck_post/" hx-vals = '{"book_id": {{detail.book_id}}}' hx-trigger="load" hx-target='#wishlist' >
        <button id='wishlist' hx-post = "/wishList_post/" hx-vals = '{"book_id": {{detail.book_id}}}' hx-trigger="click delay:0.25s" onclick='savingList(this)'>...</button>
    </div>
    <div>
        <h3>The loai</h3>
        
        {% for topic in topicList %}
            <a href="">{{ topic.topic_id.topic_name }}</a>
            <br>
        {% endfor %}
    </div>
    <h3>Your rating</h3>
    <div>
        <form action="">
            <div class="rating">
                <p>Rating: <span class="star-rating">
                    {% for i in "12345" %} 
                        {% if i == rating %}
                            <label for="rate-{{i}}" style="--i: {{i}}"><i class="fa fa-star" title="{{i}} star"></i></label>
                            <input type="radio" name="rating" id="rate-{{i}}" hx-vals='{"rate": {{i}}, "book_id": {{detail.book_id}}}' hx-post ="/rating_post/" hx-trigger="load click delay:0.25s" hx-target="#clear" hx-swap="outerHTML" checked>
                        {% else %}
                            <label for="rate-{{i}}" style="--i: {{i}}"><i class="fa fa-star" title="{{i}} star"></i></label>
                            <input type="radio" name="rating" id="rate-{{i}}" hx-vals='{"rate": {{i}}, "book_id": {{detail.book_id}}}' hx-post ="/rating_post/" hx-trigger="click delay:0.25s" hx-target="#clear" hx-swap="outerHTML">
                        {% endif %}
                    {% endfor %}    
                </span></p>
            </div>
            <div class="clear_rating">
                <input style="display: none;" type="button"  name="clear" id="clear" >
            </div>
        </form>
    </div>
{% endblock content %}


{% block scripts %}
<script src="https://unpkg.com/htmx.org@2.0.2/dist/htmx.js" integrity="sha384-yZq+5izaUBKcRgFbxgkRYwpHhHHCpp5nseXp0MEQ1A4MTWVMnqkmcuFez8x5qfxr"crossorigin="anonymous"></script> 
<script>
    function hidebutton(button){
        button.type = 'hidden'
    }
    function savingList(button){
        button.value ='saving...'
    } 
</script>
{% endblock scripts %}
    